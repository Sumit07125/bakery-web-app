<%- include('include/header') %>

<style>
  .cart-table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 2rem;
  }
  .cart-table th, .cart-table td {
    padding: 1rem;
    border-bottom: 1px solid #eee;
  }
  .cart-table th {
    text-align: left;
    font-weight: 600;
  }
  .cart-table td {
    vertical-align: middle;
  }
  .cart-table img {
    width: 80px;
    height: 80px;
    object-fit: cover;
    border-radius: 10px;
  }
  .quantity-controls a {
    margin: 0 5px;
  }
  .cart-summary {
    background-color: #f8f9fa;
    padding: 2rem;
    border-radius: 15px;
  }
</style>

<div class="container my-5">
  <h2 class="text-center mb-4">Your Shopping Cart</h2>
  <% if (products.length > 0) { %>
    <table class="cart-table">
      <thead>
        <tr>
          <th>Product</th>
          <th>Price</th>
          <th>Quantity</th>
          <th>Total</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <% products.forEach(product => { %>
          <tr>
            <td>
              <div class="d-flex align-items-center">
                <img src="<%= product.img_url %>" alt="<%= product.product_name %>">
                <span class="ms-3"><%= product.product_name %></span>
              </div>
            </td>
            <td>Rs <%= product.price %></td>
            <td>
              <div class="d-flex align-items-center quantity-controls">
                <a href="/updatecartminus/<%= product.product_id %>" class="btn btn-sm btn-outline-danger">-</a>
                <span><%= product.quantity %></span>
                <a href="/updatecartplus/<%= product.product_id %>" class="btn btn-sm btn-outline-success">+</a>
              </div>
            </td>
            <td>Rs <%= product.price * product.quantity %></td>
            <td>
              <a href="/remove_from_cart/<%= product.product_id %>" class="btn btn-sm btn-danger">Remove</a>
            </td>
          </tr>
        <% }) %>
      </tbody>
    </table>

    <div class="row justify-content-end">
      <div class="col-md-4">
        <div class="cart-summary">
          <h4 class="mb-3">Cart Summary</h4>
          <div class="d-flex justify-content-between">
            <span>Total Items:</span>
            <span><%= titem %></span>
          </div>
          <hr>
          <div class="d-flex justify-content-between">
            <h5>Total:</h5>
            <h5>Rs <%= total %></h5>
          </div>
          <div class="d-grid gap-2 mt-4">
            <a href="/billing" class="btn btn-primary">Proceed to Checkout</a>
            <a href="/" class="btn btn-secondary">Continue Shopping</a>
          </div>
        </div>
      </div>
    </div>

  <% } else { %>
    <div class="text-center">
      <p>Your cart is empty.</p>
      <a href="/" class="btn btn-primary">Continue Shopping</a>
    </div>
  <% } %>
</div>

<%- include('include/footer') %>